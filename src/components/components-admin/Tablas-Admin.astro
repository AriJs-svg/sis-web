---
import "../../style/style-admin/seccion.css";
---

<section class="data-content-section">
  <!-- Sección de búsqueda y bienvenida -->
  <section class="search-content-data">
    <div class="welcome-search-data">
      <h2 id="name-user" class="welcome-search-data__title">Cargando...</h2>
      <h5 id="ultima-conexion" class="welcome-search-data__text">Cargando...</h5>
      <!-- <p class="welcome-search-data__text">
        Aquí puedes gestionar los datos de tu aplicación de manera eficiente y
        rápida.
      </p> -->
    </div>

    <!-- Secciones de búsqueda y filtrado rápido comentadas (se mantienen así para referencia) -->
    <!-- <div class="search">
      <input
        type="text"
        class="search__input search__input--global"
        placeholder="Buscar Estudiante..."
        id="search-input"
      />
      <ul id="search-results" class="search-results">
        <li class="search-result-item">
          <i class="bx bx-search"></i>Gestión de Usuarios
        </li>
        <li class="search-result-item">
          <i class="bx bx-search"></i>Control de Notas
        </li>
        <li class="search-result-item">
          <i class="bx bx-search"></i>Reportes
        </li>
        <li class="search-result-item">
          <i class="bx bx-search"></i>Configuración
        </li>
        <li class="search-result-item"><i class="bx bx-search"></i>Ayuda</li>
      </ul>
      <button class="search__button">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="icon icon-tabler icons-tabler-outline icon-tabler-search"
        >
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"></path>
          <path d="M21 21l-6 -6"></path>
        </svg>
      </button>
    </div> -->

    <!-- <div class="section-filter-info">
      <div class="section-filter-info__title">
        <h4>Filtrado rápido</h4>
      </div>
      <div class="section-filter-info__content">
        <button class="btn-filter">Fecha</button>
        <button class="btn-filter">Estudiantes</button>
        <button class="btn-filter">Estado</button>
        <button class="btn-filter">Notas</button>
      </div>
    </div> -->
  </section>

  <!-- Sección de tarjetas de información (nuevas) -->
  <section class="info-cards-section">
    <!-- Cada tarjeta es un enlace (botón de redirección) -->
    <a href="/Admin-Control/Estudiantes" class="card-item">
      <i class="bx bxs-user card-icon"></i>
      <h3 class="card-title">Estudiantes</h3>
    </a>
    <a href="/Admin-Control/Profesores" class="card-item">
      <i class="bx bxs-user card-icon"></i>
      <h3 class="card-title">Profesores</h3>
    </a>
    <a href="/Admin-Control/Cursos" class="card-item">
      <i class="bx bxs-book-content card-icon"></i>
      <h3 class="card-title">Cursos</h3>
    </a>
    <a href="/Admin-Control/Notas" class="card-item">
      <i class="bx bxs-notepad card-icon"></i>
      <h3 class="card-title">Notas</h3>
    </a>
  </section>
</section>

<script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    cargarNombreUsuario();
  });

  async function cargarNombreUsuario() {
    try {
      const res = await fetch('http://localhost:3001/usuario', {
        method: 'GET',
        credentials: 'include'
      });
      const data = await res.json();

      console.log("Datos del usuario recibidos:", data); // 👀 Verificar qué llega desde la API

      if (!res.ok || !data.id) {
        console.warn('No se pudo obtener datos del usuario logueado o el usuario no está autenticado.');
        return;
      }

      document.getElementById('name-user').textContent = `Bienvenido/a ${data.primer_nombre} ${data.primer_apellido}`;
      document.getElementById('ultima-conexion').textContent = `Última conexión: ${data.ultima_conexion}`;
    } catch (error) {
      console.error('Error al cargar el usuario logueado:', error);
    }
  }
</script>
